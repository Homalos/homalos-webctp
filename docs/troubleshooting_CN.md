# æ•…éšœæ’æŸ¥æŒ‡å—

**ç‰ˆæœ¬**: 1.0  
**æ›´æ–°æ—¥æœŸ**: 2025-12-15

## ç›®å½•

- [æ¦‚è¿°](#æ¦‚è¿°)
- [æ•…éšœæ’æŸ¥æµç¨‹](#æ•…éšœæ’æŸ¥æµç¨‹)
- [è¿æ¥é—®é¢˜](#è¿æ¥é—®é¢˜)
- [æ€§èƒ½é—®é¢˜](#æ€§èƒ½é—®é¢˜)
- [ç¼“å­˜é—®é¢˜](#ç¼“å­˜é—®é¢˜)
- [é…ç½®é—®é¢˜](#é…ç½®é—®é¢˜)
- [æ—¥å¿—åˆ†æ](#æ—¥å¿—åˆ†æ)
- [è¯Šæ–­å·¥å…·](#è¯Šæ–­å·¥å…·)
- [é”™è¯¯ä»£ç å‚è€ƒ](#é”™è¯¯ä»£ç å‚è€ƒ)
- [è·å–å¸®åŠ©](#è·å–å¸®åŠ©)

## æ¦‚è¿°

æœ¬æŒ‡å—å¸®åŠ©æ‚¨å¿«é€Ÿè¯Šæ–­å’Œè§£å†³ homalos-webctp ç³»ç»Ÿä¸­çš„å¸¸è§é—®é¢˜ã€‚

### æ•…éšœåˆ†ç±»

**è¿æ¥é—®é¢˜**:
- WebSocket è¿æ¥å¤±è´¥
- CTP è¿æ¥å¤±è´¥
- Redis è¿æ¥å¤±è´¥

**æ€§èƒ½é—®é¢˜**:
- å»¶è¿Ÿè¿‡é«˜
- ååé‡ä½
- ç³»ç»Ÿèµ„æºå ç”¨é«˜

**ç¼“å­˜é—®é¢˜**:
- Redis ä¸å¯ç”¨
- ç¼“å­˜å‘½ä¸­ç‡ä½
- æ•°æ®ä¸ä¸€è‡´

**é…ç½®é—®é¢˜**:
- é…ç½®æ–‡ä»¶é”™è¯¯
- ç¯å¢ƒå˜é‡é—®é¢˜
- æƒé™é—®é¢˜

### è¯Šæ–­åŸåˆ™

1. **æŸ¥çœ‹æ—¥å¿—**: é¦–å…ˆæŸ¥çœ‹é”™è¯¯æ—¥å¿—
2. **æ£€æŸ¥é…ç½®**: ç¡®è®¤é…ç½®æ–‡ä»¶æ­£ç¡®
3. **éªŒè¯è¿æ¥**: æµ‹è¯•å„ä¸ªè¿æ¥æ˜¯å¦æ­£å¸¸
4. **ç›‘æ§æŒ‡æ ‡**: æŸ¥çœ‹æ€§èƒ½æŠ¥å‘Šå’Œå‘Šè­¦
5. **éš”ç¦»é—®é¢˜**: é€ä¸ªæ’æŸ¥å¯èƒ½çš„åŸå› 
6. **è®°å½•è¿‡ç¨‹**: è®°å½•æ’æŸ¥æ­¥éª¤å’Œç»“æœ

### å¸¸ç”¨å·¥å…·

- **æ—¥å¿—æ–‡ä»¶**: `logs/webctp.log`, `logs/webctp_error.log`
- **æ€§èƒ½æŠ¥å‘Š**: æ—¥å¿—ä¸­çš„æ€§èƒ½æŒ‡æ ‡æŠ¥å‘Š
- **Redis CLI**: `redis-cli` å‘½ä»¤è¡Œå·¥å…·
- **ç³»ç»Ÿç›‘æ§**: Windows æ€§èƒ½ç›‘è§†å™¨ / Linux top/htop
- **ç½‘ç»œå·¥å…·**: ping, telnet, curl


## æ•…éšœæ’æŸ¥æµç¨‹

### å¿«é€Ÿè¯Šæ–­æµç¨‹

```
1. æœåŠ¡æ˜¯å¦å¯åŠ¨ï¼Ÿ
   â”œâ”€ å¦ â†’ æ£€æŸ¥å¯åŠ¨é”™è¯¯
   â””â”€ æ˜¯ â†’ ç»§ç»­

2. èƒ½å¦è¿æ¥ WebSocketï¼Ÿ
   â”œâ”€ å¦ â†’ æ£€æŸ¥ç½‘ç»œå’Œç«¯å£
   â””â”€ æ˜¯ â†’ ç»§ç»­

3. èƒ½å¦ç™»å½•ï¼Ÿ
   â”œâ”€ å¦ â†’ æ£€æŸ¥è´¦å·å’Œ CTP è¿æ¥
   â””â”€ æ˜¯ â†’ ç»§ç»­

4. åŠŸèƒ½æ˜¯å¦æ­£å¸¸ï¼Ÿ
   â”œâ”€ å¦ â†’ æ£€æŸ¥å…·ä½“åŠŸèƒ½é”™è¯¯
   â””â”€ æ˜¯ â†’ æ£€æŸ¥æ€§èƒ½é—®é¢˜

5. æ€§èƒ½æ˜¯å¦è¾¾æ ‡ï¼Ÿ
   â”œâ”€ å¦ â†’ æŸ¥çœ‹æ€§èƒ½æŠ¥å‘Šå’Œå‘Šè­¦
   â””â”€ æ˜¯ â†’ ç³»ç»Ÿæ­£å¸¸
```

### è¯¦ç»†æ’æŸ¥æ­¥éª¤

#### æ­¥éª¤ 1: æ£€æŸ¥æœåŠ¡çŠ¶æ€

**æ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œ**:
```bash
# Windows
tasklist | findstr python

# Linux
ps aux | grep python
```

**æ£€æŸ¥ç«¯å£æ˜¯å¦ç›‘å¬**:
```bash
# Windows
netstat -ano | findstr :8080
netstat -ano | findstr :8081

# Linux
netstat -tlnp | grep 8080
netstat -tlnp | grep 8081
```

**é¢„æœŸç»“æœ**:
- åº”è¯¥çœ‹åˆ° python è¿›ç¨‹
- ç«¯å£ 8080 (MD) å’Œ 8081 (TD) åº”è¯¥åœ¨ç›‘å¬çŠ¶æ€

#### æ­¥éª¤ 2: æ£€æŸ¥æ—¥å¿—

**æŸ¥çœ‹æœ€æ–°æ—¥å¿—**:
```bash
# Windows PowerShell
Get-Content logs\webctp.log -Tail 50

# Linux
tail -50 logs/webctp.log
```

**æŸ¥çœ‹é”™è¯¯æ—¥å¿—**:
```bash
# Windows PowerShell
Get-Content logs\webctp_error.log -Tail 50

# Linux
tail -50 logs/webctp_error.log
```

**å…³æ³¨å…³é”®ä¿¡æ¯**:
- å¯åŠ¨ä¿¡æ¯
- è¿æ¥çŠ¶æ€
- é”™è¯¯æ¶ˆæ¯
- å‘Šè­¦ä¿¡æ¯

#### æ­¥éª¤ 3: æµ‹è¯•è¿æ¥

**æµ‹è¯• WebSocket è¿æ¥**:
```python
import asyncio
import websockets

async def test_connection():
    try:
        async with websockets.connect("ws://localhost:8080/ws") as ws:
            print("WebSocket è¿æ¥æˆåŠŸ")
    except Exception as e:
        print(f"WebSocket è¿æ¥å¤±è´¥: {e}")

asyncio.run(test_connection())
```

**æµ‹è¯• Redis è¿æ¥**:
```bash
redis-cli ping
# åº”è¯¥è¿”å› PONG
```

**æµ‹è¯• CTP è¿æ¥**:
- æŸ¥çœ‹æ—¥å¿—ä¸­çš„ CTP è¿æ¥çŠ¶æ€
- ç¡®è®¤å‰ç½®åœ°å€å¯è®¿é—®

#### æ­¥éª¤ 4: æ£€æŸ¥é…ç½®

**éªŒè¯é…ç½®æ–‡ä»¶**:
```bash
# æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•
python -c "import yaml; yaml.safe_load(open('config/config_md.yaml'))"
```

**æ£€æŸ¥å…³é”®é…ç½®é¡¹**:
- å‰ç½®åœ°å€æ˜¯å¦æ­£ç¡®
- ç«¯å£æ˜¯å¦å†²çª
- Redis é…ç½®æ˜¯å¦æ­£ç¡®
- æ—¥å¿—çº§åˆ«æ˜¯å¦åˆé€‚

#### æ­¥éª¤ 5: æŸ¥çœ‹æ€§èƒ½æŒ‡æ ‡

**æŸ¥çœ‹æ€§èƒ½æŠ¥å‘Š**:
```bash
# æŸ¥çœ‹æœ€è¿‘çš„æ€§èƒ½æŠ¥å‘Š
grep "æ€§èƒ½æŒ‡æ ‡æŠ¥å‘Š" logs/webctp.log -A 30 | tail -35
```

**æŸ¥çœ‹å‘Šè­¦**:
```bash
# æŸ¥çœ‹æ‰€æœ‰å‘Šè­¦
grep "âš ï¸" logs/webctp.log
```

**åˆ†ææŒ‡æ ‡**:
- å»¶è¿Ÿæ˜¯å¦æ­£å¸¸
- ååé‡æ˜¯å¦è¾¾æ ‡
- èµ„æºä½¿ç”¨æ˜¯å¦åˆç†
- ç¼“å­˜å‘½ä¸­ç‡æ˜¯å¦æ­£å¸¸


## è¿æ¥é—®é¢˜

### é—®é¢˜ 1: WebSocket è¿æ¥å¤±è´¥

#### ç—‡çŠ¶
- å®¢æˆ·ç«¯æ— æ³•è¿æ¥åˆ° WebSocket
- è¿æ¥è¶…æ—¶æˆ–è¢«æ‹’ç»
- æµè§ˆå™¨æ˜¾ç¤º "WebSocket connection failed"

#### å¯èƒ½åŸå› 

**1. æœåŠ¡æœªå¯åŠ¨**
```bash
# æ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œ
tasklist | findstr python
```

**è§£å†³æ–¹æ¡ˆ**: å¯åŠ¨æœåŠ¡
```bash
.venv\Scripts\activate
python main.py --config=./config/config_md.yaml --app_type=md
```

**2. ç«¯å£è¢«å ç”¨**
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -ano | findstr :8080
```

**è§£å†³æ–¹æ¡ˆ**: 
- ç»ˆæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹
- æˆ–ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ç«¯å£å·

**3. é˜²ç«å¢™é˜»æ­¢**

**è§£å†³æ–¹æ¡ˆ**: 
```bash
# Windows é˜²ç«å¢™æ·»åŠ è§„åˆ™
netsh advfirewall firewall add rule name="WebCTP MD" dir=in action=allow protocol=TCP localport=8080
netsh advfirewall firewall add rule name="WebCTP TD" dir=in action=allow protocol=TCP localport=8081
```

**4. ç»‘å®šåœ°å€é”™è¯¯**

**æ£€æŸ¥é…ç½®**:
```yaml
Host: 127.0.0.1  # åªå…è®¸æœ¬åœ°è¿æ¥
# æˆ–
Host: 0.0.0.0    # å…è®¸æ‰€æœ‰ç½‘ç»œæ¥å£
```

**è§£å†³æ–¹æ¡ˆ**: æ ¹æ®éœ€æ±‚ä¿®æ”¹ Host é…ç½®

#### è¯Šæ–­æ­¥éª¤

1. ç¡®è®¤æœåŠ¡å·²å¯åŠ¨
2. ç¡®è®¤ç«¯å£æœªè¢«å ç”¨
3. æµ‹è¯•æœ¬åœ°è¿æ¥
4. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
5. æŸ¥çœ‹é”™è¯¯æ—¥å¿—

#### æ—¥å¿—ç¤ºä¾‹

**æ­£å¸¸å¯åŠ¨**:
```
INFO | Application startup complete
INFO | Uvicorn running on http://127.0.0.1:8080
```

**ç«¯å£å ç”¨**:
```
ERROR | [Errno 10048] error while attempting to bind on address ('127.0.0.1', 8080): é€šå¸¸æ¯ä¸ªå¥—æ¥å­—åœ°å€(åè®®/ç½‘ç»œåœ°å€/ç«¯å£)åªå…è®¸ä½¿ç”¨ä¸€æ¬¡ã€‚
```

### é—®é¢˜ 2: CTP è¿æ¥å¤±è´¥

#### ç—‡çŠ¶
- ç™»å½•å¤±è´¥
- æ— æ³•è®¢é˜…è¡Œæƒ…
- æ— æ³•æäº¤è®¢å•
- æ—¥å¿—æ˜¾ç¤º CTP è¿æ¥é”™è¯¯

#### å¯èƒ½åŸå› 

**1. å‰ç½®åœ°å€é”™è¯¯**

**æ£€æŸ¥é…ç½®**:
```yaml
TdFrontAddress: tcp://182.254.243.31:40001
MdFrontAddress: tcp://182.254.243.31:40011
```

**è§£å†³æ–¹æ¡ˆ**: 
- ç¡®è®¤å‰ç½®åœ°å€æ­£ç¡®
- SimNow 7x24: tcp://182.254.243.31:40001 (äº¤æ˜“), tcp://182.254.243.31:40011 (è¡Œæƒ…)
- SimNow æ ‡å‡†: tcp://180.168.146.187:10130 (äº¤æ˜“), tcp://180.168.146.187:10131 (è¡Œæƒ…)

**2. è´¦å·å¯†ç é”™è¯¯**

**æ£€æŸ¥é…ç½®**:
```yaml
BrokerID: "9999"
AuthCode: "0000000000000000"
AppID: simnow_client_test
```

**è§£å†³æ–¹æ¡ˆ**: 
- ç¡®è®¤ BrokerID æ­£ç¡®ï¼ˆSimNow ä¸º "9999"ï¼‰
- ç¡®è®¤ AuthCode å’Œ AppID æ­£ç¡®
- æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç 

**3. ç½‘ç»œè¿æ¥é—®é¢˜**

**æµ‹è¯•è¿æ¥**:
```bash
# Windows
telnet 182.254.243.31 40001

# æˆ–ä½¿ç”¨ PowerShell
Test-NetConnection -ComputerName 182.254.243.31 -Port 40001
```

**è§£å†³æ–¹æ¡ˆ**: 
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
- å°è¯•ä½¿ç”¨ VPN æˆ–ä»£ç†

**4. CTP æœåŠ¡å™¨ç»´æŠ¤**

**è§£å†³æ–¹æ¡ˆ**: 
- æŸ¥çœ‹ SimNow å®˜ç½‘å…¬å‘Š
- ç­‰å¾…æœåŠ¡å™¨æ¢å¤
- å°è¯•ä½¿ç”¨å¤‡ç”¨å‰ç½®åœ°å€

#### è¯Šæ–­æ­¥éª¤

1. æ£€æŸ¥é…ç½®æ–‡ä»¶
2. æµ‹è¯•ç½‘ç»œè¿æ¥
3. æŸ¥çœ‹ CTP é”™è¯¯ç 
4. æ£€æŸ¥è´¦å·çŠ¶æ€
5. æŸ¥çœ‹æœåŠ¡å™¨å…¬å‘Š

#### å¸¸è§é”™è¯¯ç 

| é”™è¯¯ç  | è¯´æ˜ | è§£å†³æ–¹æ¡ˆ |
|--------|------|----------|
| 3 | CTP:ä¸åˆæ³•çš„ç™»å½• | æ£€æŸ¥ç”¨æˆ·åå¯†ç  |
| 7 | CTP:è¿˜æ²¡æœ‰åˆå§‹åŒ– | ç­‰å¾…åˆå§‹åŒ–å®Œæˆ |
| 63 | CTP:ç½‘ç»œè¿æ¥å¤±è´¥ | æ£€æŸ¥ç½‘ç»œå’Œå‰ç½®åœ°å€ |
| 90 | CTP:è®¤è¯å¤±è´¥ | æ£€æŸ¥ AuthCode å’Œ AppID |

#### æ—¥å¿—ç¤ºä¾‹

**è¿æ¥æˆåŠŸ**:
```
INFO | CTP å‰ç½®è¿æ¥æˆåŠŸ
INFO | ç”¨æˆ·ç™»å½•æˆåŠŸ: UserID=123456
```

**è¿æ¥å¤±è´¥**:
```
ERROR | CTP å‰ç½®è¿æ¥å¤±è´¥: ç½‘ç»œè¿æ¥å¤±è´¥
ERROR | ç”¨æˆ·ç™»å½•å¤±è´¥: ErrorID=3, ErrorMsg=CTP:ä¸åˆæ³•çš„ç™»å½•
```

### é—®é¢˜ 3: Redis è¿æ¥å¤±è´¥

#### ç—‡çŠ¶
- æ—¥å¿—æ˜¾ç¤º "Redis è¿æ¥å¤±è´¥"
- ç¼“å­˜åŠŸèƒ½ä¸å¯ç”¨
- æ€§èƒ½æŠ¥å‘Šæ˜¾ç¤ºå‘½ä¸­ç‡ä¸º 0

#### å¯èƒ½åŸå› 

**1. Redis æœåŠ¡æœªå¯åŠ¨**

**æ£€æŸ¥ Redis çŠ¶æ€**:
```bash
# Windows (WSL)
wsl
redis-cli ping

# Linux
systemctl status redis
```

**è§£å†³æ–¹æ¡ˆ**: å¯åŠ¨ Redis
```bash
# Windows (WSL)
redis-server

# Linux
sudo systemctl start redis
```

**2. Redis é…ç½®é”™è¯¯**

**æ£€æŸ¥é…ç½®**:
```yaml
Redis:
  Enabled: true
  Host: localhost
  Port: 6379
  Password: ""
```

**è§£å†³æ–¹æ¡ˆ**: 
- ç¡®è®¤ Host å’Œ Port æ­£ç¡®
- å¦‚æœ Redis è®¾ç½®äº†å¯†ç ï¼Œå¡«å†™ Password

**3. Redis è¿æ¥æ•°è¶…é™**

**æ£€æŸ¥è¿æ¥æ•°**:
```bash
redis-cli info clients
```

**è§£å†³æ–¹æ¡ˆ**: 
- å¢åŠ  Redis maxclients é…ç½®
- å‡å°‘åº”ç”¨çš„ MaxConnections é…ç½®

**4. Redis å†…å­˜ä¸è¶³**

**æ£€æŸ¥å†…å­˜**:
```bash
redis-cli info memory
```

**è§£å†³æ–¹æ¡ˆ**: 
- å¢åŠ  Redis maxmemory é…ç½®
- æ¸…ç†è¿‡æœŸæ•°æ®
- è°ƒæ•´æ·˜æ±°ç­–ç•¥

#### è¯Šæ–­æ­¥éª¤

1. ç¡®è®¤ Redis æœåŠ¡è¿è¡Œ
2. æµ‹è¯• Redis è¿æ¥
3. æ£€æŸ¥é…ç½®æ–‡ä»¶
4. æŸ¥çœ‹ Redis æ—¥å¿—
5. æ£€æŸ¥ç³»ç»Ÿèµ„æº

#### é™çº§æœºåˆ¶

**é‡è¦**: Redis è¿æ¥å¤±è´¥æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨é™çº§åˆ°ç›´æ¥æŸ¥è¯¢æ¨¡å¼ï¼Œä¸å½±å“æ ¸å¿ƒåŠŸèƒ½ã€‚

**æ—¥å¿—ç¤ºä¾‹**:
```
WARNING | Redis è¿æ¥å¤±è´¥: Connection refused
INFO | Redis ä¸å¯ç”¨ï¼Œä½¿ç”¨é™çº§æ¨¡å¼
```

**éªŒè¯é™çº§**:
- ç³»ç»Ÿä»ç„¶å¯ä»¥æ­£å¸¸è¿è¡Œ
- æ€§èƒ½ä¼šæœ‰æ‰€ä¸‹é™
- ç¼“å­˜å‘½ä¸­ç‡ä¸º 0

### é—®é¢˜ 4: å¿ƒè·³è¶…æ—¶

#### ç—‡çŠ¶
- WebSocket è¿æ¥é¢‘ç¹æ–­å¼€
- æ—¥å¿—æ˜¾ç¤º "å¿ƒè·³è¶…æ—¶"
- å®¢æˆ·ç«¯éœ€è¦é¢‘ç¹é‡è¿

#### å¯èƒ½åŸå› 

**1. ç½‘ç»œä¸ç¨³å®š**

**è§£å†³æ–¹æ¡ˆ**: 
- ä½¿ç”¨æ›´ç¨³å®šçš„ç½‘ç»œ
- ç¼©çŸ­å¿ƒè·³é—´éš”

**é…ç½®è°ƒæ•´**:
```yaml
HeartbeatInterval: 15.0  # ä» 30 ç§’ç¼©çŸ­åˆ° 15 ç§’
HeartbeatTimeout: 30.0   # ä» 60 ç§’ç¼©çŸ­åˆ° 30 ç§’
```

**2. å®¢æˆ·ç«¯æœªå“åº”å¿ƒè·³**

**è§£å†³æ–¹æ¡ˆ**: 
- ç¡®ä¿å®¢æˆ·ç«¯æ­£ç¡®å¤„ç†å¿ƒè·³æ¶ˆæ¯
- å®¢æˆ·ç«¯åº”è¯¥å“åº” ping æ¶ˆæ¯

**3. æœåŠ¡å™¨è´Ÿè½½è¿‡é«˜**

**è§£å†³æ–¹æ¡ˆ**: 
- æ£€æŸ¥ç³»ç»Ÿèµ„æºä½¿ç”¨
- ä¼˜åŒ–æ€§èƒ½
- å¢åŠ æœåŠ¡å™¨èµ„æº

#### è¯Šæ–­æ­¥éª¤

1. æ£€æŸ¥ç½‘ç»œè´¨é‡
2. æŸ¥çœ‹å¿ƒè·³æ—¥å¿—
3. æ£€æŸ¥å®¢æˆ·ç«¯å®ç°
4. ç›‘æ§æœåŠ¡å™¨è´Ÿè½½
5. è°ƒæ•´å¿ƒè·³é…ç½®


## æ€§èƒ½é—®é¢˜

### é—®é¢˜ 5: å»¶è¿Ÿè¿‡é«˜

#### ç—‡çŠ¶
- è®¢å•å»¶è¿Ÿ P95 > 200 ms
- è¡Œæƒ…å»¶è¿Ÿ > 100 ms
- é¢‘ç¹æ”¶åˆ°å»¶è¿Ÿå‘Šè­¦

#### å¯èƒ½åŸå› å’Œè§£å†³æ–¹æ¡ˆ

**1. Redis æœªå¯ç”¨æˆ–å‘½ä¸­ç‡ä½**

**æ£€æŸ¥**:
```bash
# æŸ¥çœ‹ Redis å‘½ä¸­ç‡
grep "Redis å‘½ä¸­ç‡" logs/webctp.log | tail -5
```

**è§£å†³æ–¹æ¡ˆ**:
```yaml
# å¯ç”¨ Redis
Redis:
  Enabled: true
  Host: localhost
  Port: 6379
```

**2. ç³»ç»Ÿèµ„æºä¸è¶³**

**æ£€æŸ¥**:
```bash
# æŸ¥çœ‹ç³»ç»Ÿèµ„æº
grep "ç³»ç»Ÿèµ„æº" logs/webctp.log | tail -5
```

**è§£å†³æ–¹æ¡ˆ**:
- CPU > 80%: ä¼˜åŒ–ä»£ç ã€å¢åŠ  CPU èµ„æº
- å†…å­˜ > 80%: æ¸…ç†ç¼“å­˜ã€å¢åŠ å†…å­˜
- é™ä½é‡‡æ ·ç‡å‡å°‘ç›‘æ§å¼€é”€

**3. ç½‘ç»œå»¶è¿Ÿé«˜**

**æ£€æŸ¥**:
```bash
# æµ‹è¯•ç½‘ç»œå»¶è¿Ÿ
ping 182.254.243.31
```

**è§£å†³æ–¹æ¡ˆ**:
- ä½¿ç”¨æ›´å¿«çš„ç½‘ç»œè¿æ¥
- é€‰æ‹©åœ°ç†ä½ç½®è¿‘çš„å‰ç½®æœåŠ¡å™¨
- è€ƒè™‘ä½¿ç”¨ä¸“çº¿

**4. CTP API å“åº”æ…¢**

**ç‰¹å¾**:
- å»¶è¿Ÿä¸»è¦æ¥è‡ª CTP å›è°ƒ
- å…¶ä»–æ“ä½œæ­£å¸¸

**è§£å†³æ–¹æ¡ˆ**:
- è¿™æ˜¯å¤–éƒ¨å› ç´ ï¼Œéš¾ä»¥ä¼˜åŒ–
- è€ƒè™‘ä½¿ç”¨ç”Ÿäº§ç¯å¢ƒï¼ˆæ¯” SimNow å¿«ï¼‰
- å®æ–½è¯·æ±‚åˆå¹¶ç­–ç•¥

**5. åºåˆ—åŒ–å¼€é”€å¤§**

**æ£€æŸ¥**:
- ç¡®è®¤ä½¿ç”¨ orjsonï¼ˆä¸æ˜¯æ ‡å‡† jsonï¼‰
- æŸ¥çœ‹æ—¥å¿—ä¸­çš„åºåˆ—åŒ–é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ç¡®è®¤ orjson å·²å®‰è£…
uv pip list | grep orjson
```

#### ä¼˜åŒ–å»ºè®®

**ä½è´Ÿè½½åœºæ™¯**:
```yaml
Metrics:
  SampleRate: 1.0  # 100% é‡‡æ ·
  ReportInterval: 120  # è¾ƒé•¿æŠ¥å‘Šé—´éš”
```

**é«˜è´Ÿè½½åœºæ™¯**:
```yaml
Metrics:
  SampleRate: 0.2  # 20% é‡‡æ ·
  ReportInterval: 60

Redis:
  MaxConnections: 100  # å¢åŠ è¿æ¥æ± 
```

### é—®é¢˜ 6: ååé‡ä½

#### ç—‡çŠ¶
- è®¢å•ååé‡ < 10 å•/ç§’
- ç³»ç»Ÿæ— æ³•å¤„ç†é«˜é¢‘äº¤æ˜“
- è¯·æ±‚æ’é˜Ÿä¸¥é‡

#### å¯èƒ½åŸå› å’Œè§£å†³æ–¹æ¡ˆ

**1. è¿æ¥æ± å¤ªå°**

**è§£å†³æ–¹æ¡ˆ**:
```yaml
Redis:
  MaxConnections: 100  # å¢åŠ åˆ° 100
```

**2. åŒæ­¥é˜»å¡**

**æ£€æŸ¥æ—¥å¿—**:
- æŸ¥æ‰¾ "blocking" æˆ– "waiting" ç›¸å…³æ—¥å¿—

**è§£å†³æ–¹æ¡ˆ**:
- ç¡®ä¿æ‰€æœ‰ I/O æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„
- æ£€æŸ¥æ˜¯å¦æœ‰åŒæ­¥è°ƒç”¨é˜»å¡äº‹ä»¶å¾ªç¯

**3. ç­–ç•¥æ•°é‡è¿‡å¤š**

**æ£€æŸ¥**:
```bash
# æŸ¥çœ‹æ´»è·ƒç­–ç•¥æ•°
grep "active_strategies" logs/webctp.log | tail -1
```

**è§£å†³æ–¹æ¡ˆ**:
```yaml
Strategy:
  MaxStrategies: 5  # å‡å°‘æœ€å¤§ç­–ç•¥æ•°
```

**4. æ¶ˆæ¯é˜Ÿåˆ—ç§¯å‹**

**ç‰¹å¾**:
- å†…å­˜æŒç»­å¢é•¿
- å»¶è¿ŸæŒç»­ä¸Šå‡

**è§£å†³æ–¹æ¡ˆ**:
- å¢åŠ å¤„ç†é€Ÿåº¦
- é™åˆ¶é˜Ÿåˆ—å¤§å°
- å®æ–½èƒŒå‹æœºåˆ¶

### é—®é¢˜ 7: ç³»ç»Ÿèµ„æºå ç”¨é«˜

#### CPU ä½¿ç”¨ç‡è¿‡é«˜

**ç—‡çŠ¶**:
- CPU > 80%
- é¢‘ç¹æ”¶åˆ° CPU å‘Šè­¦

**å¯èƒ½åŸå› **:

**1. é‡‡æ ·ç‡è¿‡é«˜**
```yaml
Metrics:
  SampleRate: 0.2  # é™ä½åˆ° 20%
```

**2. ç­–ç•¥è®¡ç®—å¯†é›†**
- ä¼˜åŒ–ç­–ç•¥ç®—æ³•
- é™åˆ¶ç­–ç•¥ CPU ä½¿ç”¨

**3. åºåˆ—åŒ–å¼€é”€**
- ç¡®è®¤ä½¿ç”¨ orjson
- å‡å°‘ä¸å¿…è¦çš„åºåˆ—åŒ–

**4. æ—¥å¿—çº§åˆ«è¿‡ä½**
```yaml
LogLevel: INFO  # ä¸è¦ä½¿ç”¨ DEBUG
```

#### å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜

**ç—‡çŠ¶**:
- å†…å­˜ > 80%
- é¢‘ç¹æ”¶åˆ°å†…å­˜å‘Šè­¦
- å¯èƒ½å‡ºç° OOM

**å¯èƒ½åŸå› **:

**1. å†…å­˜æ³„æ¼**

**è¯Šæ–­**:
```python
# ä½¿ç”¨ memory_profiler
from memory_profiler import profile

@profile
def your_function():
    pass
```

**2. ç¼“å­˜æ•°æ®è¿‡å¤š**

**è§£å†³æ–¹æ¡ˆ**:
```yaml
Redis:
  MarketSnapshotTTL: 30  # ç¼©çŸ­ TTL
  MarketTickTTL: 3
```

**3. æ»‘åŠ¨çª—å£è¿‡å¤§**

**è§£å†³æ–¹æ¡ˆ**:
- ä¿®æ”¹ MetricsCollector.WINDOW_SIZE_SECONDS
- ä» 600 ç§’å‡å°‘åˆ° 300 ç§’

**4. ç­–ç•¥å†…å­˜æ³„æ¼**

**è§£å†³æ–¹æ¡ˆ**:
```yaml
Strategy:
  DefaultMaxMemoryMB: 256  # é™åˆ¶å•ç­–ç•¥å†…å­˜
```

### é—®é¢˜ 8: æ€§èƒ½æŠ–åŠ¨

#### ç—‡çŠ¶
- å»¶è¿Ÿæ³¢åŠ¨å¤§
- å¶å°”å‡ºç°æé«˜å»¶è¿Ÿ
- P99 è¿œé«˜äº P95

#### å¯èƒ½åŸå› 

**1. GC (åƒåœ¾å›æ”¶) æš‚åœ**

**è§£å†³æ–¹æ¡ˆ**:
- å‡å°‘å¯¹è±¡åˆ›å»º
- ä½¿ç”¨å¯¹è±¡æ± 
- ä¼˜åŒ–å†…å­˜ä½¿ç”¨

**2. ç½‘ç»œæ³¢åŠ¨**

**è¯Šæ–­**:
```bash
# æŒç»­ ping æµ‹è¯•
ping -t 182.254.243.31
```

**è§£å†³æ–¹æ¡ˆ**:
- ä½¿ç”¨æ›´ç¨³å®šçš„ç½‘ç»œ
- å®æ–½é‡è¯•æœºåˆ¶

**3. Redis æ…¢æŸ¥è¯¢**

**æ£€æŸ¥**:
```bash
redis-cli slowlog get 10
```

**è§£å†³æ–¹æ¡ˆ**:
- ä¼˜åŒ– Redis æŸ¥è¯¢
- å¢åŠ  Redis å†…å­˜
- è°ƒæ•´æ·˜æ±°ç­–ç•¥

**4. CTP æœåŠ¡å™¨æ³¢åŠ¨**

**ç‰¹å¾**:
- æ‰€æœ‰è¯·æ±‚åŒæ—¶å˜æ…¢
- ä¸æœ¬åœ°ç³»ç»Ÿæ— å…³

**è§£å†³æ–¹æ¡ˆ**:
- è¿™æ˜¯å¤–éƒ¨å› ç´ 
- è€ƒè™‘ä½¿ç”¨å¤šä¸ªå‰ç½®åœ°å€
- å®æ–½æ•…éšœè½¬ç§»


## ç¼“å­˜é—®é¢˜

### é—®é¢˜ 9: Redis å‘½ä¸­ç‡ä½

#### ç—‡çŠ¶
- ç¼“å­˜å‘½ä¸­ç‡ < 60%
- é¢‘ç¹æ”¶åˆ°å‘½ä¸­ç‡å‘Šè­¦
- æ€§èƒ½æå‡ä¸æ˜æ˜¾

#### å¯èƒ½åŸå› å’Œè§£å†³æ–¹æ¡ˆ

**1. TTL è®¾ç½®è¿‡çŸ­**

**å½“å‰é…ç½®**:
```yaml
Redis:
  MarketSnapshotTTL: 60
  MarketTickTTL: 5
  OrderTTL: 86400
```

**è§£å†³æ–¹æ¡ˆ**: å»¶é•¿ TTL
```yaml
Redis:
  MarketSnapshotTTL: 120  # å»¶é•¿åˆ° 2 åˆ†é’Ÿ
  MarketTickTTL: 10       # å»¶é•¿åˆ° 10 ç§’
```

**2. æŸ¥è¯¢çš„æ•°æ®å˜åŒ–é¢‘ç¹**

**ç‰¹å¾**:
- å®æ—¶ tick æ•°æ®å‘½ä¸­ç‡ä½æ˜¯æ­£å¸¸çš„
- å¿«ç…§æ•°æ®å‘½ä¸­ç‡åº”è¯¥è¾ƒé«˜

**è§£å†³æ–¹æ¡ˆ**:
- æ¥å—å®æ—¶æ•°æ®çš„ä½å‘½ä¸­ç‡
- ä¼˜åŒ–å¿«ç…§æ•°æ®çš„ç¼“å­˜ç­–ç•¥

**3. Redis å†…å­˜ä¸è¶³å¯¼è‡´æ•°æ®è¢«é©±é€**

**æ£€æŸ¥**:
```bash
redis-cli info memory
redis-cli info stats | grep evicted
```

**è§£å†³æ–¹æ¡ˆ**:
```conf
# redis.conf
maxmemory 4gb
maxmemory-policy allkeys-lru
```

**4. ç¼“å­˜é¢„çƒ­ä¸å……åˆ†**

**è§£å†³æ–¹æ¡ˆ**:
- å¯åŠ¨æ—¶é¢„åŠ è½½çƒ­ç‚¹æ•°æ®
- å®æ–½ç¼“å­˜é¢„çƒ­ç­–ç•¥

**5. æŸ¥è¯¢æ¨¡å¼ä¸é€‚åˆç¼“å­˜**

**ç‰¹å¾**:
- å¤§é‡ä¸€æ¬¡æ€§æŸ¥è¯¢
- æŸ¥è¯¢åˆ†å¸ƒéå¸¸åˆ†æ•£

**è§£å†³æ–¹æ¡ˆ**:
- åˆ†ææŸ¥è¯¢æ¨¡å¼
- è°ƒæ•´ç¼“å­˜ç­–ç•¥
- è€ƒè™‘æ˜¯å¦éœ€è¦ç¼“å­˜

#### ä¼˜åŒ–å»ºè®®

**åˆ†æå‘½ä¸­ç‡**:
```bash
# æŸ¥çœ‹å‘½ä¸­ç‡è¶‹åŠ¿
grep "Redis å‘½ä¸­ç‡" logs/webctp.log | tail -20
```

**è°ƒæ•´é˜ˆå€¼**:
```yaml
Metrics:
  CacheHitRateWarningThreshold: 40.0  # é™ä½é˜ˆå€¼
```

### é—®é¢˜ 10: ç¼“å­˜æ•°æ®ä¸ä¸€è‡´

#### ç—‡çŠ¶
- ç¼“å­˜æ•°æ®ä¸ CTP æ•°æ®ä¸ä¸€è‡´
- æŸ¥è¯¢ç»“æœä¸å‡†ç¡®
- å¶å°”å‡ºç°è„æ•°æ®

#### å¯èƒ½åŸå› å’Œè§£å†³æ–¹æ¡ˆ

**1. TTL è®¾ç½®è¿‡é•¿**

**é—®é¢˜**:
- æ•°æ®å·²æ›´æ–°ï¼Œä½†ç¼“å­˜æœªè¿‡æœŸ

**è§£å†³æ–¹æ¡ˆ**:
```yaml
Redis:
  MarketSnapshotTTL: 30  # ç¼©çŸ­ TTL
```

**2. ç¼“å­˜æ›´æ–°å¤±è´¥**

**æ£€æŸ¥æ—¥å¿—**:
```bash
grep "Redis.*å¤±è´¥" logs/webctp.log
```

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ Redis è¿æ¥çŠ¶æ€
- å®æ–½é‡è¯•æœºåˆ¶
- æ·»åŠ æ›´æ–°å¤±è´¥å‘Šè­¦

**3. å¹¶å‘æ›´æ–°å†²çª**

**é—®é¢˜**:
- å¤šä¸ªè¿›ç¨‹åŒæ—¶æ›´æ–°ç¼“å­˜
- æœ€åå†™å…¥çš„æ•°æ®è¦†ç›–äº†æ­£ç¡®æ•°æ®

**è§£å†³æ–¹æ¡ˆ**:
- ä½¿ç”¨ Redis äº‹åŠ¡
- å®æ–½ä¹è§‚é”
- ä½¿ç”¨ç‰ˆæœ¬å·

**4. ç¼“å­˜ç©¿é€**

**é—®é¢˜**:
- æŸ¥è¯¢ä¸å­˜åœ¨çš„æ•°æ®
- ç»•è¿‡ç¼“å­˜ç›´æ¥æŸ¥è¯¢ CTP

**è§£å†³æ–¹æ¡ˆ**:
- ç¼“å­˜ç©ºç»“æœï¼ˆçŸ­ TTLï¼‰
- ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨

#### æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥

**æ‰‹åŠ¨éªŒè¯**:
```python
# æ¯”è¾ƒç¼“å­˜å’Œ CTP æ•°æ®
cached_data = await cache.get("market:au2602")
ctp_data = await ctp_client.query_market("au2602")

if cached_data != ctp_data:
    print("æ•°æ®ä¸ä¸€è‡´!")
```

**è‡ªåŠ¨æ£€æŸ¥**:
- å®šæœŸæŠ½æ ·æ£€æŸ¥
- è®°å½•ä¸ä¸€è‡´æƒ…å†µ
- è‡ªåŠ¨åˆ·æ–°ç¼“å­˜

### é—®é¢˜ 11: Redis æ€§èƒ½ä¸‹é™

#### ç—‡çŠ¶
- Redis æ“ä½œå»¶è¿Ÿå¢åŠ 
- ç¼“å­˜æ“ä½œè¶…æ—¶
- ç³»ç»Ÿæ•´ä½“æ€§èƒ½ä¸‹é™

#### å¯èƒ½åŸå› å’Œè§£å†³æ–¹æ¡ˆ

**1. Redis å†…å­˜ç¢ç‰‡**

**æ£€æŸ¥**:
```bash
redis-cli info memory | grep mem_fragmentation_ratio
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# å¦‚æœç¢ç‰‡ç‡ > 1.5
redis-cli memory purge
```

**2. Redis æŒä¹…åŒ–å½±å“æ€§èƒ½**

**æ£€æŸ¥é…ç½®**:
```conf
# redis.conf
save 900 1
save 300 10
save 60 10000
appendfsync everysec
```

**è§£å†³æ–¹æ¡ˆ**:
- è°ƒæ•´æŒä¹…åŒ–ç­–ç•¥
- ä½¿ç”¨ SSD å­˜å‚¨
- è€ƒè™‘ç¦ç”¨æŒä¹…åŒ–ï¼ˆå¦‚æœå¯ä»¥æ¥å—æ•°æ®ä¸¢å¤±ï¼‰

**3. Redis æ…¢æŸ¥è¯¢**

**æ£€æŸ¥**:
```bash
redis-cli slowlog get 10
```

**è§£å†³æ–¹æ¡ˆ**:
- ä¼˜åŒ–æŸ¥è¯¢å‘½ä»¤
- é¿å…ä½¿ç”¨ KEYS å‘½ä»¤
- ä½¿ç”¨ SCAN æ›¿ä»£ KEYS

**4. Redis è¿æ¥æ•°è¿‡å¤š**

**æ£€æŸ¥**:
```bash
redis-cli info clients
```

**è§£å†³æ–¹æ¡ˆ**:
```yaml
Redis:
  MaxConnections: 50  # å‡å°‘è¿æ¥æ± å¤§å°
```

**5. Redis æœåŠ¡å™¨èµ„æºä¸è¶³**

**æ£€æŸ¥**:
- CPU ä½¿ç”¨ç‡
- å†…å­˜ä½¿ç”¨ç‡
- ç£ç›˜ I/O

**è§£å†³æ–¹æ¡ˆ**:
- å¢åŠ æœåŠ¡å™¨èµ„æº
- ä¼˜åŒ– Redis é…ç½®
- è€ƒè™‘ Redis é›†ç¾¤


## é…ç½®é—®é¢˜

### é—®é¢˜ 12: é…ç½®æ–‡ä»¶é”™è¯¯

#### ç—‡çŠ¶
- æœåŠ¡å¯åŠ¨å¤±è´¥
- æ—¥å¿—æ˜¾ç¤ºé…ç½®è§£æé”™è¯¯
- åŠŸèƒ½å¼‚å¸¸

#### å¸¸è§é…ç½®é”™è¯¯

**1. YAML è¯­æ³•é”™è¯¯**

**é”™è¯¯ç¤ºä¾‹**:
```yaml
Redis:
  Enabled: true
  Host localhost  # ç¼ºå°‘å†’å·
  Port: 6379
```

**æ­£ç¡®æ ¼å¼**:
```yaml
Redis:
  Enabled: true
  Host: localhost  # æ·»åŠ å†’å·
  Port: 6379
```

**éªŒè¯è¯­æ³•**:
```bash
python -c "import yaml; yaml.safe_load(open('config/config_md.yaml'))"
```

**2. ç¼©è¿›é”™è¯¯**

**é”™è¯¯ç¤ºä¾‹**:
```yaml
Redis:
  Enabled: true
Host: localhost  # ç¼©è¿›é”™è¯¯
  Port: 6379
```

**æ­£ç¡®æ ¼å¼**:
```yaml
Redis:
  Enabled: true
  Host: localhost  # æ­£ç¡®ç¼©è¿›
  Port: 6379
```

**3. æ•°æ®ç±»å‹é”™è¯¯**

**é”™è¯¯ç¤ºä¾‹**:
```yaml
Port: "8080"  # å­—ç¬¦ä¸²ï¼Œåº”è¯¥æ˜¯æ•°å­—
Enabled: "true"  # å­—ç¬¦ä¸²ï¼Œåº”è¯¥æ˜¯å¸ƒå°”å€¼
```

**æ­£ç¡®æ ¼å¼**:
```yaml
Port: 8080  # æ•°å­—
Enabled: true  # å¸ƒå°”å€¼
```

**4. å¿…éœ€å­—æ®µç¼ºå¤±**

**é”™è¯¯ç¤ºä¾‹**:
```yaml
# ç¼ºå°‘ TdFrontAddress
MdFrontAddress: tcp://182.254.243.31:40011
BrokerID: "9999"
```

**æ­£ç¡®æ ¼å¼**:
```yaml
TdFrontAddress: tcp://182.254.243.31:40001  # æ·»åŠ å¿…éœ€å­—æ®µ
MdFrontAddress: tcp://182.254.243.31:40011
BrokerID: "9999"
```

#### é…ç½®éªŒè¯æ¸…å•

- [ ] YAML è¯­æ³•æ­£ç¡®
- [ ] ç¼©è¿›ä¸€è‡´ï¼ˆä½¿ç”¨ç©ºæ ¼ï¼Œä¸ç”¨ Tabï¼‰
- [ ] æ•°æ®ç±»å‹æ­£ç¡®
- [ ] æ‰€æœ‰å¿…éœ€å­—æ®µå­˜åœ¨
- [ ] ç«¯å£å·æœªè¢«å ç”¨
- [ ] å‰ç½®åœ°å€æ­£ç¡®
- [ ] Redis é…ç½®æ­£ç¡®ï¼ˆå¦‚æœå¯ç”¨ï¼‰

### é—®é¢˜ 13: ç¯å¢ƒå˜é‡é—®é¢˜

#### ç—‡çŠ¶
- é…ç½®æœªç”Ÿæ•ˆ
- ä½¿ç”¨äº†é”™è¯¯çš„é…ç½®å€¼
- ç¯å¢ƒå˜é‡è¦†ç›–äº†é…ç½®æ–‡ä»¶

#### ç¯å¢ƒå˜é‡ä¼˜å…ˆçº§

```
ç¯å¢ƒå˜é‡ > é…ç½®æ–‡ä»¶ > é»˜è®¤å€¼
```

#### å¸¸è§é—®é¢˜

**1. ç¯å¢ƒå˜é‡æœªè®¾ç½®**

**æ£€æŸ¥**:
```bash
# Windows CMD
echo %WEBCTP_REDIS_HOST%

# Windows PowerShell
$env:WEBCTP_REDIS_HOST

# Linux
echo $WEBCTP_REDIS_HOST
```

**è®¾ç½®**:
```bash
# Windows CMD
set WEBCTP_REDIS_HOST=localhost

# Windows PowerShell
$env:WEBCTP_REDIS_HOST="localhost"

# Linux
export WEBCTP_REDIS_HOST=localhost
```

**2. ç¯å¢ƒå˜é‡å‘½åé”™è¯¯**

**æ­£ç¡®æ ¼å¼**:
```bash
WEBCTP_REDIS_HOST=localhost
WEBCTP_REDIS_PORT=6379
WEBCTP_METRICS_ENABLED=true
```

**é”™è¯¯æ ¼å¼**:
```bash
REDIS_HOST=localhost  # ç¼ºå°‘ WEBCTP_ å‰ç¼€
webctp_redis_host=localhost  # åº”è¯¥å…¨å¤§å†™
```

**3. ç¯å¢ƒå˜é‡ç±»å‹é”™è¯¯**

**æ­£ç¡®è®¾ç½®**:
```bash
# å¸ƒå°”å€¼
set WEBCTP_METRICS_ENABLED=true

# æ•°å­—
set WEBCTP_REDIS_PORT=6379

# å­—ç¬¦ä¸²
set WEBCTP_REDIS_HOST=localhost
```

**4. ç¯å¢ƒå˜é‡æœªæŒä¹…åŒ–**

**é—®é¢˜**:
- å…³é—­ç»ˆç«¯åç¯å¢ƒå˜é‡ä¸¢å¤±

**è§£å†³æ–¹æ¡ˆ**:
```bash
# Windows: è®¾ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡
setx WEBCTP_REDIS_HOST localhost

# Linux: æ·»åŠ åˆ° ~/.bashrc
echo 'export WEBCTP_REDIS_HOST=localhost' >> ~/.bashrc
source ~/.bashrc
```

### é—®é¢˜ 14: æƒé™é—®é¢˜

#### ç—‡çŠ¶
- æ— æ³•åˆ›å»ºæ—¥å¿—æ–‡ä»¶
- æ— æ³•å†™å…¥ con_file ç›®å½•
- æ— æ³•è¯»å–é…ç½®æ–‡ä»¶

#### å¸¸è§æƒé™é—®é¢˜

**1. æ—¥å¿—ç›®å½•æƒé™ä¸è¶³**

**é”™è¯¯æ—¥å¿—**:
```
PermissionError: [Errno 13] Permission denied: 'logs/webctp.log'
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# Windows
icacls logs /grant Users:F

# Linux
chmod 755 logs
```

**2. con_file ç›®å½•æƒé™ä¸è¶³**

**è§£å†³æ–¹æ¡ˆ**:
```bash
# Windows
icacls con_file /grant Users:F

# Linux
chmod 755 con_file
```

**3. é…ç½®æ–‡ä»¶æƒé™ä¸è¶³**

**è§£å†³æ–¹æ¡ˆ**:
```bash
# Windows
icacls config /grant Users:R

# Linux
chmod 644 config/*.yaml
```

**4. è™šæ‹Ÿç¯å¢ƒæƒé™é—®é¢˜**

**è§£å†³æ–¹æ¡ˆ**:
```bash
# é‡æ–°åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
rm -rf .venv
uv sync
```

### é—®é¢˜ 15: ç«¯å£å†²çª

#### ç—‡çŠ¶
- æœåŠ¡å¯åŠ¨å¤±è´¥
- é”™è¯¯ä¿¡æ¯: "Address already in use"
- ç«¯å£è¢«å ç”¨

#### è¯Šæ–­å’Œè§£å†³

**1. æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹**

```bash
# Windows
netstat -ano | findstr :8080
tasklist | findstr <PID>

# Linux
lsof -i :8080
```

**2. ç»ˆæ­¢å ç”¨è¿›ç¨‹**

```bash
# Windows
taskkill /PID <PID> /F

# Linux
kill -9 <PID>
```

**3. ä¿®æ”¹é…ç½®ä½¿ç”¨å…¶ä»–ç«¯å£**

```yaml
# config_md.yaml
Port: 8082  # æ”¹ä¸ºå…¶ä»–ç«¯å£

# config_td.yaml
Port: 8083  # æ”¹ä¸ºå…¶ä»–ç«¯å£
```

**4. æ£€æŸ¥é˜²ç«å¢™è§„åˆ™**

```bash
# Windows
netsh advfirewall firewall show rule name=all | findstr 8080

# Linux
sudo iptables -L -n | grep 8080
```


## æ—¥å¿—åˆ†æ

### æ—¥å¿—æ–‡ä»¶ä½ç½®

**ä¸»æ—¥å¿—æ–‡ä»¶**:
- `logs/webctp.log` - æ‰€æœ‰æ—¥å¿—ï¼ˆINFO åŠä»¥ä¸Šï¼‰
- `logs/webctp_error.log` - é”™è¯¯æ—¥å¿—ï¼ˆERROR åŠä»¥ä¸Šï¼‰

### æ—¥å¿—çº§åˆ«

| çº§åˆ« | è¯´æ˜ | ç”¨é€” |
|------|------|------|
| DEBUG | è°ƒè¯•ä¿¡æ¯ | å¼€å‘è°ƒè¯• |
| INFO | ä¸€èˆ¬ä¿¡æ¯ | æ­£å¸¸è¿è¡Œæ—¥å¿— |
| WARNING | è­¦å‘Šä¿¡æ¯ | æ½œåœ¨é—®é¢˜ |
| ERROR | é”™è¯¯ä¿¡æ¯ | é”™è¯¯å’Œå¼‚å¸¸ |
| CRITICAL | ä¸¥é‡é”™è¯¯ | ç³»ç»Ÿå´©æºƒ |

### æ—¥å¿—æ ¼å¼

```
2025-12-15 10:30:45 | INFO | src.apps.md_app:startup:45 | è¡Œæƒ…æœåŠ¡å¯åŠ¨æˆåŠŸ
```

**æ ¼å¼è¯´æ˜**:
- `2025-12-15 10:30:45` - æ—¶é—´æˆ³
- `INFO` - æ—¥å¿—çº§åˆ«
- `src.apps.md_app:startup:45` - æ¨¡å—:å‡½æ•°:è¡Œå·
- `è¡Œæƒ…æœåŠ¡å¯åŠ¨æˆåŠŸ` - æ—¥å¿—æ¶ˆæ¯

### å¸¸ç”¨æ—¥å¿—æŸ¥è¯¢

#### æŸ¥çœ‹æœ€æ–°æ—¥å¿—

```bash
# Windows PowerShell
Get-Content logs\webctp.log -Tail 50

# Linux
tail -50 logs/webctp.log
```

#### å®æ—¶ç›‘æ§æ—¥å¿—

```bash
# Windows PowerShell
Get-Content logs\webctp.log -Wait -Tail 50

# Linux
tail -f logs/webctp.log
```

#### æŸ¥æ‰¾é”™è¯¯æ—¥å¿—

```bash
# Windows PowerShell
Select-String -Path logs\webctp.log -Pattern "ERROR"

# Linux
grep "ERROR" logs/webctp.log
```

#### æŸ¥æ‰¾ç‰¹å®šæ—¶é—´æ®µçš„æ—¥å¿—

```bash
# Linux
sed -n '/2025-12-15 10:00/,/2025-12-15 11:00/p' logs/webctp.log
```

#### æŸ¥æ‰¾ç‰¹å®šæ¨¡å—çš„æ—¥å¿—

```bash
# æŸ¥æ‰¾ Redis ç›¸å…³æ—¥å¿—
grep "cache_manager" logs/webctp.log

# æŸ¥æ‰¾ CTP ç›¸å…³æ—¥å¿—
grep "ctp" logs/webctp.log
```

#### æŸ¥æ‰¾æ€§èƒ½æŠ¥å‘Š

```bash
# æŸ¥çœ‹æœ€è¿‘çš„æ€§èƒ½æŠ¥å‘Š
grep "æ€§èƒ½æŒ‡æ ‡æŠ¥å‘Š" logs/webctp.log -A 30 | tail -35
```

#### æŸ¥æ‰¾å‘Šè­¦

```bash
# æŸ¥çœ‹æ‰€æœ‰å‘Šè­¦
grep "âš ï¸" logs/webctp.log

# æŸ¥çœ‹ç‰¹å®šç±»å‹çš„å‘Šè­¦
grep "å»¶è¿Ÿå‘Šè­¦" logs/webctp.log
grep "Redis å‘½ä¸­ç‡å‘Šè­¦" logs/webctp.log
grep "CPU ä½¿ç”¨ç‡å‘Šè­¦" logs/webctp.log
```

### æ—¥å¿—åˆ†ææŠ€å·§

#### 1. è¯†åˆ«å¯åŠ¨é—®é¢˜

**æŸ¥æ‰¾å¯åŠ¨ç›¸å…³æ—¥å¿—**:
```bash
grep "startup\|å¯åŠ¨" logs/webctp.log | tail -20
```

**æ­£å¸¸å¯åŠ¨æ ‡å¿—**:
```
INFO | Application startup complete
INFO | Uvicorn running on http://127.0.0.1:8080
INFO | CTP å‰ç½®è¿æ¥æˆåŠŸ
```

**å¯åŠ¨å¤±è´¥æ ‡å¿—**:
```
ERROR | é…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥
ERROR | Redis è¿æ¥å¤±è´¥
ERROR | CTP å‰ç½®è¿æ¥å¤±è´¥
```

#### 2. è¯†åˆ«è¿æ¥é—®é¢˜

**æŸ¥æ‰¾è¿æ¥ç›¸å…³æ—¥å¿—**:
```bash
grep "è¿æ¥\|connection" logs/webctp.log | tail -20
```

**è¿æ¥æˆåŠŸæ ‡å¿—**:
```
INFO | WebSocket è¿æ¥å»ºç«‹
INFO | CTP å‰ç½®è¿æ¥æˆåŠŸ
INFO | Redis è¿æ¥æˆåŠŸ
```

**è¿æ¥å¤±è´¥æ ‡å¿—**:
```
ERROR | WebSocket è¿æ¥å¤±è´¥
ERROR | CTP å‰ç½®è¿æ¥å¤±è´¥
ERROR | Redis è¿æ¥å¤±è´¥
```

#### 3. è¯†åˆ«æ€§èƒ½é—®é¢˜

**æŸ¥æ‰¾æ€§èƒ½ç›¸å…³æ—¥å¿—**:
```bash
grep "å»¶è¿Ÿ\|latency\|æ€§èƒ½" logs/webctp.log | tail -20
```

**æ€§èƒ½æ­£å¸¸æ ‡å¿—**:
```
INFO | order_latency P95: 78.6 ms
INFO | market_latency P95: 35.4 ms
INFO | Redis å‘½ä¸­ç‡: 87.3%
```

**æ€§èƒ½å¼‚å¸¸æ ‡å¿—**:
```
WARNING | âš ï¸ å»¶è¿Ÿå‘Šè­¦: order_latency P95 å»¶è¿Ÿ (150.25 ms) è¶…è¿‡é˜ˆå€¼
WARNING | âš ï¸ Redis å‘½ä¸­ç‡å‘Šè­¦: å½“å‰å‘½ä¸­ç‡ (35.50%) ä½äºé˜ˆå€¼
WARNING | âš ï¸ CPU ä½¿ç”¨ç‡å‘Šè­¦: å½“å‰ CPU ä½¿ç”¨ç‡ (85.3%) è¶…è¿‡é˜ˆå€¼
```

#### 4. è¯†åˆ«é”™è¯¯æ¨¡å¼

**æŸ¥æ‰¾é‡å¤é”™è¯¯**:
```bash
# ç»Ÿè®¡é”™è¯¯ç±»å‹
grep "ERROR" logs/webctp.log | cut -d'|' -f4 | sort | uniq -c | sort -rn
```

**æŸ¥æ‰¾å¼‚å¸¸å †æ ˆ**:
```bash
grep -A 10 "Traceback" logs/webctp.log
```

### æ—¥å¿—ç®¡ç†

#### æ—¥å¿—è½®è½¬

**é…ç½®æ—¥å¿—è½®è½¬**:
```python
# åœ¨ä»£ç ä¸­é…ç½®
logger.add(
    "logs/webctp.log",
    rotation="500 MB",      # å•æ–‡ä»¶ 500MB
    retention="7 days",     # ä¿ç•™ 7 å¤©
    compression="zip"       # å‹ç¼©æ—§æ—¥å¿—
)
```

#### æ¸…ç†æ—§æ—¥å¿—

```bash
# Windows PowerShell
Get-ChildItem logs\*.log | Where-Object {$_.LastWriteTime -lt (Get-Date).AddDays(-7)} | Remove-Item

# Linux
find logs/ -name "*.log" -mtime +7 -delete
```

#### æ—¥å¿—å¤§å°ç›‘æ§

```bash
# Windows PowerShell
Get-ChildItem logs\*.log | Select-Object Name, @{Name="Size(MB)";Expression={$_.Length/1MB}}

# Linux
du -h logs/*.log
```

### æ—¥å¿—çº§åˆ«è°ƒæ•´

#### ä¸´æ—¶è°ƒæ•´

**ä¿®æ”¹é…ç½®æ–‡ä»¶**:
```yaml
LogLevel: DEBUG  # ä¸´æ—¶å¯ç”¨ DEBUG çº§åˆ«
```

**é‡å¯æœåŠ¡**:
```bash
# åœæ­¢æœåŠ¡ (Ctrl+C)
# é‡æ–°å¯åŠ¨
python main.py --config=./config/config_md.yaml --app_type=md
```

#### ç”Ÿäº§ç¯å¢ƒå»ºè®®

```yaml
LogLevel: INFO  # ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ INFO
```

**åŸå› **:
- DEBUG çº§åˆ«ä¼šäº§ç”Ÿå¤§é‡æ—¥å¿—
- å½±å“æ€§èƒ½
- å ç”¨å¤§é‡ç£ç›˜ç©ºé—´


## è¯Šæ–­å·¥å…·

### å†…ç½®è¯Šæ–­å·¥å…·

#### 1. æ€§èƒ½æŠ¥å‘Š

**æŸ¥çœ‹æ€§èƒ½æŠ¥å‘Š**:
```bash
grep "æ€§èƒ½æŒ‡æ ‡æŠ¥å‘Š" logs/webctp.log -A 30 | tail -35
```

**æŠ¥å‘Šå†…å®¹**:
- å»¶è¿ŸæŒ‡æ ‡ï¼ˆP50, P95, P99ï¼‰
- è®¡æ•°å™¨ï¼ˆè®¢å•æ•°ã€è¡Œæƒ…æ•°ï¼‰
- Redis å‘½ä¸­ç‡
- ååé‡
- ç¬æ—¶å€¼ï¼ˆæ´»è·ƒè¿æ¥æ•°ï¼‰
- ç³»ç»Ÿèµ„æºï¼ˆCPUã€å†…å­˜ï¼‰

**ä½¿ç”¨åœºæ™¯**:
- æ€§èƒ½åŸºçº¿æµ‹è¯•
- æ€§èƒ½é—®é¢˜è¯Šæ–­
- ä¼˜åŒ–æ•ˆæœéªŒè¯

#### 2. å‘Šè­¦ç³»ç»Ÿ

**æŸ¥çœ‹å‘Šè­¦**:
```bash
grep "âš ï¸" logs/webctp.log
```

**å‘Šè­¦ç±»å‹**:
- å»¶è¿Ÿå‘Šè­¦
- Redis å‘½ä¸­ç‡å‘Šè­¦
- CPU ä½¿ç”¨ç‡å‘Šè­¦
- å†…å­˜ä½¿ç”¨ç‡å‘Šè­¦

**ä½¿ç”¨åœºæ™¯**:
- å®æ—¶ç›‘æ§
- å¼‚å¸¸æ£€æµ‹
- æ€§èƒ½é¢„è­¦

#### 3. å¥åº·æ£€æŸ¥

**Redis å¥åº·æ£€æŸ¥**:
```bash
redis-cli ping
# åº”è¯¥è¿”å› PONG
```

**WebSocket å¥åº·æ£€æŸ¥**:
```python
import asyncio
import websockets

async def health_check():
    try:
        async with websockets.connect("ws://localhost:8080/ws") as ws:
            print("âœ… WebSocket å¥åº·")
    except Exception as e:
        print(f"âŒ WebSocket å¼‚å¸¸: {e}")

asyncio.run(health_check())
```

### å¤–éƒ¨è¯Šæ–­å·¥å…·

#### 1. Redis ç›‘æ§å·¥å…·

**Redis CLI**:
```bash
# æŸ¥çœ‹ Redis ä¿¡æ¯
redis-cli info

# æŸ¥çœ‹å†…å­˜ä½¿ç”¨
redis-cli info memory

# æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯
redis-cli info stats

# æŸ¥çœ‹å®¢æˆ·ç«¯è¿æ¥
redis-cli info clients

# æŸ¥çœ‹æ…¢æŸ¥è¯¢
redis-cli slowlog get 10

# ç›‘æ§å‘½ä»¤
redis-cli monitor
```

**Redis Desktop Manager**:
- å›¾å½¢åŒ– Redis ç®¡ç†å·¥å…·
- å¯è§†åŒ–æ•°æ®æµè§ˆ
- æ€§èƒ½ç›‘æ§

#### 2. ç³»ç»Ÿç›‘æ§å·¥å…·

**Windows æ€§èƒ½ç›‘è§†å™¨**:
```bash
# å¯åŠ¨æ€§èƒ½ç›‘è§†å™¨
perfmon
```

**ç›‘æ§æŒ‡æ ‡**:
- CPU ä½¿ç”¨ç‡
- å†…å­˜ä½¿ç”¨ç‡
- ç£ç›˜ I/O
- ç½‘ç»œ I/O

**Linux å·¥å…·**:
```bash
# CPU å’Œå†…å­˜
top
htop

# ç½‘ç»œè¿æ¥
netstat -tlnp

# ç£ç›˜ I/O
iostat

# ç³»ç»Ÿèµ„æº
vmstat
```

#### 3. ç½‘ç»œè¯Šæ–­å·¥å…·

**Ping**:
```bash
ping 182.254.243.31
```

**Telnet**:
```bash
telnet 182.254.243.31 40001
```

**PowerShell Test-NetConnection**:
```powershell
Test-NetConnection -ComputerName 182.254.243.31 -Port 40001
```

**Wireshark**:
- ç½‘ç»œæŠ“åŒ…å·¥å…·
- åˆ†æç½‘ç»œæµé‡
- è¯Šæ–­ç½‘ç»œé—®é¢˜

#### 4. Python æ€§èƒ½åˆ†æå·¥å…·

**cProfile**:
```python
import cProfile
import pstats

# æ€§èƒ½åˆ†æ
cProfile.run('your_function()', 'profile_stats')

# æŸ¥çœ‹ç»“æœ
p = pstats.Stats('profile_stats')
p.sort_stats('cumulative')
p.print_stats(20)
```

**memory_profiler**:
```python
from memory_profiler import profile

@profile
def your_function():
    # ä½ çš„ä»£ç 
    pass
```

**py-spy**:
```bash
# å®‰è£…
pip install py-spy

# é‡‡æ ·åˆ†æ
py-spy top --pid <PID>

# ç”Ÿæˆç«ç„°å›¾
py-spy record -o profile.svg --pid <PID>
```

### è¯Šæ–­è„šæœ¬

#### ç³»ç»Ÿå¥åº·æ£€æŸ¥è„šæœ¬

```python
# scripts/health_check.py
import asyncio
import redis
import websockets
import psutil

async def check_health():
    """ç³»ç»Ÿå¥åº·æ£€æŸ¥"""
    print("=== ç³»ç»Ÿå¥åº·æ£€æŸ¥ ===\n")
    
    # 1. WebSocket æ£€æŸ¥
    try:
        async with websockets.connect("ws://localhost:8080/ws", timeout=5) as ws:
            print("âœ… WebSocket (MD): æ­£å¸¸")
    except Exception as e:
        print(f"âŒ WebSocket (MD): å¼‚å¸¸ - {e}")
    
    try:
        async with websockets.connect("ws://localhost:8081/ws", timeout=5) as ws:
            print("âœ… WebSocket (TD): æ­£å¸¸")
    except Exception as e:
        print(f"âŒ WebSocket (TD): å¼‚å¸¸ - {e}")
    
    # 2. Redis æ£€æŸ¥
    try:
        r = redis.Redis(host='localhost', port=6379, socket_timeout=5)
        r.ping()
        print("âœ… Redis: æ­£å¸¸")
    except Exception as e:
        print(f"âŒ Redis: å¼‚å¸¸ - {e}")
    
    # 3. ç³»ç»Ÿèµ„æºæ£€æŸ¥
    cpu_percent = psutil.cpu_percent(interval=1)
    memory = psutil.virtual_memory()
    
    print(f"\nğŸ“Š ç³»ç»Ÿèµ„æº:")
    print(f"  CPU: {cpu_percent:.1f}%")
    print(f"  å†…å­˜: {memory.percent:.1f}% ({memory.used/1024/1024:.0f} MB)")
    
    if cpu_percent > 80:
        print("  âš ï¸ CPU ä½¿ç”¨ç‡è¿‡é«˜")
    if memory.percent > 80:
        print("  âš ï¸ å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜")

if __name__ == "__main__":
    asyncio.run(check_health())
```

#### æ€§èƒ½æµ‹è¯•è„šæœ¬

```python
# scripts/performance_test.py
import asyncio
import time
import websockets
import json
from statistics import quantiles

async def test_latency(uri, count=100):
    """æµ‹è¯•å»¶è¿Ÿ"""
    latencies = []
    
    async with websockets.connect(uri) as ws:
        # ç™»å½•
        login_msg = {
            "MsgType": "ReqUserLogin",
            "BrokerID": "9999",
            "UserID": "your_user_id",
            "Password": "your_password"
        }
        await ws.send(json.dumps(login_msg))
        await ws.recv()
        
        # æµ‹è¯•å»¶è¿Ÿ
        for i in range(count):
            start = time.time()
            
            # å‘é€æŸ¥è¯¢è¯·æ±‚
            query_msg = {
                "MsgType": "ReqQryInvestorPosition",
                "InstrumentID": ""
            }
            await ws.send(json.dumps(query_msg))
            await ws.recv()
            
            latency = (time.time() - start) * 1000
            latencies.append(latency)
            
            await asyncio.sleep(0.1)
        
        # è®¡ç®—ç»Ÿè®¡
        sorted_lat = sorted(latencies)
        p50 = sorted_lat[len(sorted_lat) // 2]
        p95 = sorted_lat[int(len(sorted_lat) * 0.95)]
        p99 = sorted_lat[int(len(sorted_lat) * 0.99)]
        
        print(f"å»¶è¿Ÿç»Ÿè®¡ ({count} æ¬¡è¯·æ±‚):")
        print(f"  P50: {p50:.2f} ms")
        print(f"  P95: {p95:.2f} ms")
        print(f"  P99: {p99:.2f} ms")
        print(f"  å¹³å‡: {sum(latencies)/len(latencies):.2f} ms")

if __name__ == "__main__":
    asyncio.run(test_latency("ws://localhost:8081/ws"))
```

### æ—¥å¿—åˆ†æè„šæœ¬

```python
# scripts/analyze_logs.py
import re
from collections import defaultdict

def analyze_errors(log_file):
    """åˆ†æé”™è¯¯æ—¥å¿—"""
    error_counts = defaultdict(int)
    
    with open(log_file, 'r', encoding='utf-8') as f:
        for line in f:
            if 'ERROR' in line:
                # æå–é”™è¯¯ç±»å‹
                match = re.search(r'ERROR.*?:\s*(.+?)(?:\n|$)', line)
                if match:
                    error_type = match.group(1)[:50]  # å‰50ä¸ªå­—ç¬¦
                    error_counts[error_type] += 1
    
    print("=== é”™è¯¯ç»Ÿè®¡ ===")
    for error, count in sorted(error_counts.items(), key=lambda x: x[1], reverse=True):
        print(f"{count:4d} - {error}")

def analyze_performance(log_file):
    """åˆ†ææ€§èƒ½æŠ¥å‘Š"""
    latencies = []
    
    with open(log_file, 'r', encoding='utf-8') as f:
        content = f.read()
        
        # æå– P95 å»¶è¿Ÿ
        matches = re.findall(r'order_latency.*?P95:\s*([\d.]+)\s*ms', content)
        latencies = [float(m) for m in matches]
    
    if latencies:
        print("\n=== è®¢å•å»¶è¿Ÿè¶‹åŠ¿ ===")
        print(f"æœ€å° P95: {min(latencies):.2f} ms")
        print(f"æœ€å¤§ P95: {max(latencies):.2f} ms")
        print(f"å¹³å‡ P95: {sum(latencies)/len(latencies):.2f} ms")
        print(f"æ ·æœ¬æ•°: {len(latencies)}")

if __name__ == "__main__":
    analyze_errors("logs/webctp.log")
    analyze_performance("logs/webctp.log")
```


## é”™è¯¯ä»£ç å‚è€ƒ

### CTP é”™è¯¯ä»£ç 

#### å¸¸è§é”™è¯¯ç 

| é”™è¯¯ç  | è¯´æ˜ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
|--------|------|----------|----------|
| 0 | æ­£ç¡® | - | - |
| 3 | ä¸åˆæ³•çš„ç™»å½• | ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ | æ£€æŸ¥è´¦å·å¯†ç  |
| 4 | ç”¨æˆ·ä¸æ´»è·ƒ | è´¦å·è¢«å†»ç»“ | è”ç³»åˆ¸å•† |
| 7 | è¿˜æ²¡æœ‰åˆå§‹åŒ– | CTP æœªåˆå§‹åŒ–å®Œæˆ | ç­‰å¾…åˆå§‹åŒ– |
| 22 | é‡å¤çš„æŠ¥å• | è®¢å•é‡å¤æäº¤ | æ£€æŸ¥è®¢å•é€»è¾‘ |
| 31 | æŠ¥å•ä¸å­˜åœ¨ | è®¢å•å·ä¸å­˜åœ¨ | æ£€æŸ¥è®¢å•å· |
| 36 | è¶…è¿‡æœ€å¤§æŠ¥å•æ•° | æŠ¥å•æ•°é‡è¶…é™ | å‡å°‘æŠ¥å•é¢‘ç‡ |
| 50 | èµ„é‡‘ä¸è¶³ | è´¦æˆ·èµ„é‡‘ä¸è¶³ | å……å€¼æˆ–å‡å°‘è®¢å•é‡ |
| 63 | ç½‘ç»œè¿æ¥å¤±è´¥ | ç½‘ç»œé—®é¢˜ | æ£€æŸ¥ç½‘ç»œè¿æ¥ |
| 90 | è®¤è¯å¤±è´¥ | AuthCode æˆ– AppID é”™è¯¯ | æ£€æŸ¥è®¤è¯ä¿¡æ¯ |

#### é”™è¯¯ç æŸ¥è¯¢

**åœ¨æ—¥å¿—ä¸­æŸ¥æ‰¾é”™è¯¯ç **:
```bash
grep "ErrorID" logs/webctp.log
```

**é”™è¯¯ç æ ¼å¼**:
```
ERROR | ç”¨æˆ·ç™»å½•å¤±è´¥: ErrorID=3, ErrorMsg=CTP:ä¸åˆæ³•çš„ç™»å½•
```

### ç³»ç»Ÿé”™è¯¯ä»£ç 

#### Python å¼‚å¸¸

| å¼‚å¸¸ç±»å‹ | è¯´æ˜ | å¸¸è§åŸå›  |
|----------|------|----------|
| ConnectionError | è¿æ¥é”™è¯¯ | ç½‘ç»œé—®é¢˜ã€æœåŠ¡æœªå¯åŠ¨ |
| TimeoutError | è¶…æ—¶é”™è¯¯ | æ“ä½œè¶…æ—¶ |
| PermissionError | æƒé™é”™è¯¯ | æ–‡ä»¶æƒé™ä¸è¶³ |
| FileNotFoundError | æ–‡ä»¶æœªæ‰¾åˆ° | é…ç½®æ–‡ä»¶ç¼ºå¤± |
| ValueError | å€¼é”™è¯¯ | é…ç½®å€¼ç±»å‹é”™è¯¯ |
| KeyError | é”®é”™è¯¯ | é…ç½®é¡¹ç¼ºå¤± |

#### Redis é”™è¯¯

| é”™è¯¯ | è¯´æ˜ | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| Connection refused | è¿æ¥è¢«æ‹’ç» | å¯åŠ¨ Redis æœåŠ¡ |
| NOAUTH | éœ€è¦è®¤è¯ | æä¾› Redis å¯†ç  |
| OOM | å†…å­˜ä¸è¶³ | å¢åŠ  Redis å†…å­˜ |
| READONLY | åªè¯»æ¨¡å¼ | æ£€æŸ¥ Redis é…ç½® |

### åº”ç”¨é”™è¯¯ä»£ç 

#### WebSocket é”™è¯¯

| çŠ¶æ€ç  | è¯´æ˜ | åŸå›  |
|--------|------|------|
| 1000 | æ­£å¸¸å…³é—­ | æ­£å¸¸æ–­å¼€è¿æ¥ |
| 1001 | ç«¯ç‚¹ç¦»å¼€ | æœåŠ¡å™¨å…³é—­ |
| 1002 | åè®®é”™è¯¯ | WebSocket åè®®é”™è¯¯ |
| 1003 | ä¸æ”¯æŒçš„æ•°æ® | æ•°æ®ç±»å‹é”™è¯¯ |
| 1006 | å¼‚å¸¸å…³é—­ | è¿æ¥å¼‚å¸¸æ–­å¼€ |
| 1011 | æœåŠ¡å™¨é”™è¯¯ | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

#### HTTP é”™è¯¯

| çŠ¶æ€ç  | è¯´æ˜ | åŸå›  |
|--------|------|------|
| 400 | é”™è¯¯è¯·æ±‚ | è¯·æ±‚æ ¼å¼é”™è¯¯ |
| 401 | æœªæˆæƒ | éœ€è¦è®¤è¯ |
| 403 | ç¦æ­¢è®¿é—® | æƒé™ä¸è¶³ |
| 404 | æœªæ‰¾åˆ° | èµ„æºä¸å­˜åœ¨ |
| 500 | æœåŠ¡å™¨é”™è¯¯ | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |
| 503 | æœåŠ¡ä¸å¯ç”¨ | æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ |

## è·å–å¸®åŠ©

### è‡ªåŠ©èµ„æº

**æ–‡æ¡£**:
- [README](../README_CN.md) - é¡¹ç›®æ¦‚è¿°å’Œå¿«é€Ÿå¼€å§‹
- [å¼€å‘æ–‡æ¡£](./development_CN.md) - å¼€å‘æŒ‡å—å’Œæ¶æ„è¯´æ˜
- [ç›‘æ§æŒ‡å—](./monitoring_guide_CN.md) - æ€§èƒ½ç›‘æ§é…ç½®
- [è¿ç§»æŒ‡å—](./migration_guide_CN.md) - ç‰ˆæœ¬å‡çº§æŒ‡å—
- [æ€§èƒ½æŠ¥å‘Š](./performance_report_CN.md) - æ€§èƒ½ä¼˜åŒ–æˆæœ

**æ—¥å¿—åˆ†æ**:
```bash
# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
grep "ERROR" logs/webctp.log | tail -50

# æŸ¥çœ‹å‘Šè­¦
grep "âš ï¸" logs/webctp.log

# æŸ¥çœ‹æ€§èƒ½æŠ¥å‘Š
grep "æ€§èƒ½æŒ‡æ ‡æŠ¥å‘Š" logs/webctp.log -A 30 | tail -35
```

### ç¤¾åŒºæ”¯æŒ

**QQ ç¾¤**: 446042777

**GitHub Issues**: 
- æŠ¥å‘Š Bug
- åŠŸèƒ½è¯·æ±‚
- æŠ€æœ¯è®¨è®º

### é—®é¢˜æŠ¥å‘Šæ¨¡æ¿

æäº¤é—®é¢˜æ—¶ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

```markdown
## ç¯å¢ƒä¿¡æ¯
- æ“ä½œç³»ç»Ÿ: Windows 11 / Linux Ubuntu 22.04
- Python ç‰ˆæœ¬: 3.13.0
- é¡¹ç›®ç‰ˆæœ¬: v0.2.0
- Redis ç‰ˆæœ¬: 7.2.3 (å¦‚æœä½¿ç”¨)

## é—®é¢˜æè¿°
[æ¸…æ™°æè¿°é‡åˆ°çš„é—®é¢˜]

## å¤ç°æ­¥éª¤
1. [æ­¥éª¤ 1]
2. [æ­¥éª¤ 2]
3. [æ­¥éª¤ 3]

## é¢„æœŸè¡Œä¸º
[æè¿°é¢„æœŸçš„æ­£å¸¸è¡Œä¸º]

## å®é™…è¡Œä¸º
[æè¿°å®é™…å‘ç”Ÿçš„æƒ…å†µ]

## é”™è¯¯æ—¥å¿—
```
[ç²˜è´´ç›¸å…³çš„é”™è¯¯æ—¥å¿—]
```

## é…ç½®æ–‡ä»¶
```yaml
[ç²˜è´´ç›¸å…³çš„é…ç½®å†…å®¹ï¼Œéšè—æ•æ„Ÿä¿¡æ¯]
```

## å·²å°è¯•çš„è§£å†³æ–¹æ¡ˆ
[åˆ—å‡ºå·²ç»å°è¯•è¿‡çš„è§£å†³æ–¹æ³•]

## å…¶ä»–ä¿¡æ¯
[ä»»ä½•å…¶ä»–ç›¸å…³ä¿¡æ¯]
```

### ç´§æ€¥é—®é¢˜å¤„ç†

**ä¸¥é‡é—®é¢˜**:
- ç³»ç»Ÿå´©æºƒ
- æ•°æ®ä¸¢å¤±
- å®‰å…¨æ¼æ´

**å¤„ç†æµç¨‹**:
1. ç«‹å³åœæ­¢æœåŠ¡
2. å¤‡ä»½æ—¥å¿—å’Œæ•°æ®
3. è®°å½•é—®é¢˜ç°åœº
4. è”ç³»æŠ€æœ¯æ”¯æŒ
5. ç­‰å¾…æŒ‡å¯¼åå†é‡å¯

### å¸¸è§é—®é¢˜å¿«é€Ÿç´¢å¼•

**è¿æ¥é—®é¢˜**:
- [WebSocket è¿æ¥å¤±è´¥](#é—®é¢˜-1-websocket-è¿æ¥å¤±è´¥)
- [CTP è¿æ¥å¤±è´¥](#é—®é¢˜-2-ctp-è¿æ¥å¤±è´¥)
- [Redis è¿æ¥å¤±è´¥](#é—®é¢˜-3-redis-è¿æ¥å¤±è´¥)

**æ€§èƒ½é—®é¢˜**:
- [å»¶è¿Ÿè¿‡é«˜](#é—®é¢˜-5-å»¶è¿Ÿè¿‡é«˜)
- [ååé‡ä½](#é—®é¢˜-6-ååé‡ä½)
- [ç³»ç»Ÿèµ„æºå ç”¨é«˜](#é—®é¢˜-7-ç³»ç»Ÿèµ„æºå ç”¨é«˜)

**ç¼“å­˜é—®é¢˜**:
- [Redis å‘½ä¸­ç‡ä½](#é—®é¢˜-9-redis-å‘½ä¸­ç‡ä½)
- [ç¼“å­˜æ•°æ®ä¸ä¸€è‡´](#é—®é¢˜-10-ç¼“å­˜æ•°æ®ä¸ä¸€è‡´)
- [Redis æ€§èƒ½ä¸‹é™](#é—®é¢˜-11-redis-æ€§èƒ½ä¸‹é™)

**é…ç½®é—®é¢˜**:
- [é…ç½®æ–‡ä»¶é”™è¯¯](#é—®é¢˜-12-é…ç½®æ–‡ä»¶é”™è¯¯)
- [ç¯å¢ƒå˜é‡é—®é¢˜](#é—®é¢˜-13-ç¯å¢ƒå˜é‡é—®é¢˜)
- [æƒé™é—®é¢˜](#é—®é¢˜-14-æƒé™é—®é¢˜)

### æŠ€æœ¯æ”¯æŒè”ç³»æ–¹å¼

**é‚®ç®±**: donnymoving@gmail.com

**å“åº”æ—¶é—´**:
- å·¥ä½œæ—¥: 24 å°æ—¶å†…
- å‘¨æœ«: 48 å°æ—¶å†…
- ç´§æ€¥é—®é¢˜: å°½å¿«å“åº”

---

## é™„å½•

### A. æ•…éšœæ’æŸ¥æ¸…å•

**å¯åŠ¨é—®é¢˜**:
- [ ] æ£€æŸ¥ Python ç‰ˆæœ¬ï¼ˆ3.13ï¼‰
- [ ] æ£€æŸ¥è™šæ‹Ÿç¯å¢ƒå·²æ¿€æ´»
- [ ] æ£€æŸ¥ä¾èµ–å·²å®‰è£…ï¼ˆuv syncï¼‰
- [ ] æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•
- [ ] æ£€æŸ¥ç«¯å£æœªè¢«å ç”¨
- [ ] æ£€æŸ¥æ—¥å¿—ç›®å½•æƒé™

**è¿æ¥é—®é¢˜**:
- [ ] æ£€æŸ¥æœåŠ¡å·²å¯åŠ¨
- [ ] æ£€æŸ¥ç«¯å£ç›‘å¬çŠ¶æ€
- [ ] æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
- [ ] æ£€æŸ¥ç½‘ç»œè¿æ¥
- [ ] æ£€æŸ¥å‰ç½®åœ°å€æ­£ç¡®
- [ ] æ£€æŸ¥è´¦å·å¯†ç æ­£ç¡®

**æ€§èƒ½é—®é¢˜**:
- [ ] æŸ¥çœ‹æ€§èƒ½æŠ¥å‘Š
- [ ] æ£€æŸ¥ Redis çŠ¶æ€
- [ ] æ£€æŸ¥ç³»ç»Ÿèµ„æº
- [ ] æ£€æŸ¥ç½‘ç»œå»¶è¿Ÿ
- [ ] æ£€æŸ¥é…ç½®æ˜¯å¦ä¼˜åŒ–
- [ ] æŸ¥çœ‹å‘Šè­¦æ—¥å¿—

**ç¼“å­˜é—®é¢˜**:
- [ ] æ£€æŸ¥ Redis è¿è¡Œ
- [ ] æ£€æŸ¥ Redis é…ç½®
- [ ] æŸ¥çœ‹å‘½ä¸­ç‡
- [ ] æ£€æŸ¥ TTL è®¾ç½®
- [ ] æ£€æŸ¥ Redis å†…å­˜
- [ ] æŸ¥çœ‹æ…¢æŸ¥è¯¢

### B. å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

```bash
# æœåŠ¡ç®¡ç†
python main.py --config=./config/config_md.yaml --app_type=md
python main.py --config=./config/config_td.yaml --app_type=td

# æ—¥å¿—æŸ¥çœ‹
tail -f logs/webctp.log
grep "ERROR" logs/webctp.log
grep "âš ï¸" logs/webctp.log

# Redis ç®¡ç†
redis-cli ping
redis-cli info
redis-cli monitor

# ç³»ç»Ÿç›‘æ§
top
htop
netstat -tlnp

# ç½‘ç»œæµ‹è¯•
ping 182.254.243.31
telnet 182.254.243.31 40001
```

### C. ç›¸å…³æ–‡æ¡£

- [README](../README_CN.md) - é¡¹ç›®æ¦‚è¿°
- [å¼€å‘æ–‡æ¡£](./development_CN.md) - å¼€å‘æŒ‡å—
- [ç›‘æ§æŒ‡å—](./monitoring_guide_CN.md) - ç›‘æ§é…ç½®
- [è¿ç§»æŒ‡å—](./migration_guide_CN.md) - å‡çº§æŒ‡å—
- [æ€§èƒ½æŠ¥å‘Š](./performance_report_CN.md) - æ€§èƒ½æ•°æ®

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2025-12-15  
**ç»´æŠ¤è€…**: homalos-webctp å›¢é˜Ÿ

